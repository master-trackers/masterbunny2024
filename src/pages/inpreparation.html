<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Countdown</title>
    <link rel="icon" href="/assets/bunny.png" type="image/png">
    <meta name="msvalidate.01" content="8DF6B8C1C97521142EFB1F3437EC4E4C" />
    <meta name="description" content="Master Trackers is preparing to track the Easter Bunny.">
    <script src="/assets/timeworker.js"></script>
    <!-- Meta tags for Bing -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.1.3/TweenLite.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.20.6/easing/EasePack.min.js"></script>
    <meta name="msvalidate.01" content="8DF6B8C1C97521142EFB1F3437EC4E4C" />
    <script src="https://mastertrackers.statuspage.io/embed/script.js"></script>

    <!-- Optional Open Graph tags for better sharing on social media -->
    <meta property="og:title" content="Master Trackers">
    <meta property="og:description" content="Master Trackers is preparing to track the Easter Bunny.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="http://master-trackers.xyz">
    <meta property="og:image" content="/assets/bunny.png">
    
    <!-- Twitter Card tags for better sharing on Twitter -->
    <meta name="twitter:card" content="/assets/bunny.png">
    <meta name="twitter:title" content="Master Trackers">
    <meta name="twitter:description" content="Master Trackers is preparing to track the Easter Bunny.">
    <meta name="twitter:image" content="/assets/bunny.png">
    
    <!-- Canonical URL to avoid duplicate content issues -->
    <link rel="canonical" href="http://master-trackers.xyz">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            font-size: 17px;
            background-image: url('/assets/santaprepares.png');
    background-size:auto; /* Cover ensures the image covers the entire background */
    background-repeat: no-repeat; /* Prevents the image from repeating */
    background-position: center; /* Centers the image horizontally and vertically */

            /* Dark grey background */
            color: #fff;
            /* White text color */
            margin: 0;
            padding: 0;
            position: relative;
            height: 100vh;
            font-weight: normal;
        }

        
        #countdown {
    margin-top: 100px;
    font-size: 78px; /* Large font size */
    text-align: center;
    font-family: 'Roboto', sans-serif;
    color: #fff; /* White text color */
    margin: 0;
    padding: 0;
    padding-top: 100px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 80vh; /* Adjusted height for countdown */
    font-weight: normal; /* Set font weight to normal */
}

#launchestimate {
    font-size: 28px; /* Adjust font size as needed */
    text-align: center;
    font-family: 'Roboto', sans-serif;
    color: #fff; /* White text color */
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    font-weight: normal; /* Set font weight to normal */
    position: absolute;
    bottom: 30%;
    left: 30%;
    right: 30%
}


        /* Overlay styles */
        .overlay {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 9999;
        }

        /* Settings button styles */
        .settings-btn {
            background-color: #333;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .settings-btn:hover {
            background-color: #555;
        }

        .settingsiframe {
  width: 100%;
      height: 100%;
      border-color: transparent;
      
}
    /* Settings popup styles */
    .settings-popup {
      width: 50%;
      height: 50%;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 99999;
      background-color: #333;
      color: white;
      padding: 10px;
      border-radius: 20px;
      border-color: #f0f8ff;
      box-shadow: 0px 0px 2px rgba(0, 0, 0, 0.2);
      display: none;
      /* Initially hidden */
    }

        /* Close button for the settings popup */
        .close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            color: white;
            cursor: pointer;
        }

        #tween-info {
            position: fixed;
            bottom: 10px;
            left: 10px;
            background-color: #1b1b1b;
            border: 1px solid #cccccc85;
            border-radius: 5px;
            padding: 10px;
            z-index: 200000;
            display: flex;
            align-items: center;
        }

        #tween-speed {
            font-weight: bold;
            color: white;
            margin-right: 10px;
        }

        #speed-value {
            color: white;
        }

        #countdownButtonContainer {
            display: flex;
            justify-content: flex-end;
            /* Align items to the right */
            align-items: center;
            height: 40px;
        }

        #countdownButton {
            background-color: #666;
            border: none;
            cursor: pointer;
            width: 100%;
            height: 100%;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: transform 0.3s;
            /* Hover animation */
        }

        #countdownButton2 {
            background-color: #666;
            border: none;
            cursor: pointer;
            width: 100%;
            height: 100%;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: transform 0.3s;
            /* Hover animation */
        }

        #countdownButton:hover {
            transform: scale(1.1);
            /* Hover animation */
        }

        #countdownButton img {
            max-width: 100%;
            max-height: 100%;
        }

        #countdownButton {
            background: none;
            border: none;
            cursor: pointer;
            z-index: 999999;
        }
        .top-bar2 {
      width: 90%;
      height: 20%;
      position: fixed;
      color: white;
      top: 16%;
      z-index: 999;
      display: flex;
      justify-content: center;
      zoom: 88%;
      /* Center content */
      align-items: center;
      padding: 0;
      /* Remove padding */
      background-color: transparent;
      left: 50%;
      /* Center the bar */
      transform: translateX(-50%);
      /* Adjust for the bar's width */
    }

    .info-container {
      display: flex;
    }

    .info-box {
      flex: 1;
      padding: 20px;
      text-align: center;
      color: white;
      background-color: #333;
      margin: 0 10px;
      /* Adjust margin for spacing between boxes */
      border-radius: 10px;
      /* Slightly curved edges */
      box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.5);
      /* Box shadow for depth */
    }
    .title {
      font-size: 0.8em;
      margin-bottom: 5px;
    }

    .data {
      font-weight: bold;
      font-size: 1.5em;
    }
    
    .notes {
      font-weight: bold;
      font-size: 1.1em;
    }
    #overlay {
      position: fixed;
      top: 150px;
      /* Adjust this value as needed */
      right: 25px;
      /* Adjust this value as needed */
      z-index: 1999;
    }
    #tween-info {

position: fixed;
bottom: 10px;
left: 10px;
background-color: #1b1b1b;
border: 1px solid #cccccc85;
border-radius: 5px;
padding: 10px;
z-index: 200000;
display: none; /* flex */
align-items: center;
}
    </style>
</head>

<body>

    
    <div id="preptext" class="top-bar2">
        <div class="info-container">
            <div class="info-box">
                <span class="title">Status:</span>
                <span id="lastCityInfo" class="data">Santa is in Preparation. Expected Launch Soon!</span><br/>
                <span class="notes" id="notes"></span>
            </div>
            <div class="info-box">
                <span class="title">Baskets Loaded:</span>
                <span id="giftsloaded" class="data">LOADING!!!</span><br/>
                <span class="notes" id="notes">The amount of Easter Baskets that have been loaded onto the Easter Bunny's aircraft.</span>
            </div>
            <div class="info-box">
                <span class="title">Baskets Awaiting Loading:</span>
                <span id="giftsreadytoload" class="data">LOADING!!!</span><br/>
                <span class="notes" id="notes">The amount of Easter Baskets that are waiting to be loaded onto the Easter Bunny's aircraft.</span>
            </div>
            <div class="info-box">
                <span class="title">Estimated time:</span>
                <span id="timebetween" class="data">LOADING!!!</span><br/>
                <span class="notes" id="notes">The time until the Easter Bunny's aircraft fills up.</span>
            </div>
            <div class="info-box">
                <span class="title">Your Basket:</span>
                <span id="presentinfo" class="data">Not yet available</span><br/>
                <span class="notes" id="notes">The number gift basket you are assigned.</span>
            </div>
            <div class="info-box">
                <span class="title">Aircraft Weight:</span>
                <span id="weightinfo" class="data">Not yet available</span><br/>
                <span class="notes" id="notes">Measured in eg (eggs).</span>
            </div>
        </div>
       
    </div>
    
        
  

    
    <!-- Overlay with settings button -->
    <div class="overlay">
        <button class="settings-btn" onclick="toggleSettings()">Settings</button>
    </div>

    <!-- Settings popup -->
    <div id="settingsPopup" class="settings-popup">
        <!-- Close button -->
        <span class="close-btn" onclick="toggleSettings()">X</span>
        <!-- Settings page iframe -->
        <iframe src="/embed/settings" class="settingsiframe"></iframe>
    </div>
    <div id="countdown"></div>
    <script>
      
      
    </script>
</body><style>

    .discord-button {
      position: fixed;
          bottom: 60px;
          right: 20px;
          z-index: 9999;
    }
    
      .discord-button button {
          background-color: #333;
          color: white;
          padding: 10px 20px;
          border: none;
          border-radius: 5px;
          cursor: pointer;
          display: flex;
          align-items: center;
          transition: background-color 0.3s;
    }
    
    .discord-button button:hover {
    background-color: #555;
    }
      
    
      .discord-button button img {
          height: 15px;
          margin-left: 5px;
          border-radius: 3px;
      }
    </style>
    <!-- Fixed position Discord button -->
    <div class="discord-button">
      <button onclick="window.open('https://discord.gg/AVSJQmF6zP')">
          Discord  <img src="https://static.vecteezy.com/system/resources/previews/006/892/625/original/discord-logo-icon-editorial-free-vector.jpg" hidden alt="Discord Icon">
      </button>
    </div>

</html><script>
    document.addEventListener('DOMContentLoaded', function() {
      // Get the current year
      var currentYear = new Date(currenttimeunixsec).getFullYear();
      
      // Select all span elements with the id 'year'
      var yearElements = document.querySelectorAll('span#year');
      
      // Update the text content of each element to the current year
      yearElements.forEach(function(element) {
        element.textContent = currentYear;
      });
    });
  </script>
    <script>
// Hide the message element initially
let countdownDate;

document.getElementById("preptext").style.display = 'none';

// Predefined messages for Santa's status updates with corresponding time remaining in seconds
const messages = [
{ timeUntil: 10790, message: "We've connected to satelites. We will begin tracking baskets shortly.", imagesrc: "https://t4.ftcdn.net/jpg/06/95/69/29/360_F_695692961_OeZbpXMtIz8hJvgAw7ZKHaE2VjGKPqba.jpg" },
{ timeUntil: 10500, message: "The Easter Bunny is currently recruiting loaders.", imagesrc: "https://t4.ftcdn.net/jpg/06/95/69/29/360_F_695692961_OeZbpXMtIz8hJvgAw7ZKHaE2VjGKPqba.jpg" },
  
{ timeUntil: 10200, message: "ðŸŒ¸ The chicks are chirping with excitement for Easter morning! ðŸ¥", imagesrc: "https://t4.ftcdn.net/jpg/06/95/69/29/360_F_695692961_OeZbpXMtIz8hJvgAw7ZKHaE2VjGKPqba.jpg" },
  { timeUntil: 9900, message: "ðŸ¥š The eggs are fresh from the coop! Time to decorate! ðŸŽ¨", imagesrc: "https://t4.ftcdn.net/jpg/06/95/69/29/360_F_695692961_OeZbpXMtIz8hJvgAw7ZKHaE2VjGKPqba.jpg" },
  { timeUntil: 9600, message: "ðŸŒ· The Easter Bunny is preparing surprises! Can you feel the excitement?", imagesrc: "https://t4.ftcdn.net/jpg/06/95/69/29/360_F_695692961_OeZbpXMtIz8hJvgAw7ZKHaE2VjGKPqba.jpg" },
  { timeUntil: 9300, message: "ðŸŽµ Spring songs fill the air as we await Easter morning!", imagesrc: "https://t4.ftcdn.net/jpg/06/95/69/29/360_F_695692961_OeZbpXMtIz8hJvgAw7ZKHaE2VjGKPqba.jpg" },
  { timeUntil: 9000, message: "ðŸŒ¸ The garden is abloom with Easter cheer and joy!", imagesrc: "https://t4.ftcdn.net/jpg/06/95/69/29/360_F_695692961_OeZbpXMtIz8hJvgAw7ZKHaE2VjGKPqba.jpg" },
  { timeUntil: 8700, message: "âœ¨ The eggs are sparkling in their baskets, ready for the hunt!", imagesrc: "https://t4.ftcdn.net/jpg/06/95/69/29/360_F_695692961_OeZbpXMtIz8hJvgAw7ZKHaE2VjGKPqba.jpg" },
  { timeUntil: 8400, message: "ðŸ° The Easter Bunny's helpers are hopping into action!", imagesrc: "https://t4.ftcdn.net/jpg/06/95/69/29/360_F_695692961_OeZbpXMtIz8hJvgAw7ZKHaE2VjGKPqba.jpg" },
  { timeUntil: 8100, message: "âœ¨ The Easter Basket is glowing under the spring sun!", imagesrc: "https://t4.ftcdn.net/jpg/06/95/69/29/360_F_695692961_OeZbpXMtIz8hJvgAw7ZKHaE2VjGKPqba.jpg" },
  { timeUntil: 7800, message: "ðŸ£ The chicks are getting ready for a fun-filled Easter parade!", imagesrc: "https://t4.ftcdn.net/jpg/06/95/69/29/360_F_695692961_OeZbpXMtIz8hJvgAw7ZKHaE2VjGKPqba.jpg" },
  { timeUntil: 7500, message: "ðŸŒ¸ The magic of Easter is building! Are you ready for the festivities?", imagesrc: "https://t4.ftcdn.net/jpg/06/95/69/29/360_F_695692961_OeZbpXMtIz8hJvgAw7ZKHaE2VjGKPqba.jpg" },
  { timeUntil: 7200, message: "ðŸŽ‰ The meadow is buzzing with excitement! What's your favorite Easter memory?", imagesrc: "https://t4.ftcdn.net/jpg/06/95/69/29/360_F_695692961_OeZbpXMtIz8hJvgAw7ZKHaE2VjGKPqba.jpg" },
  { timeUntil: 6900, message: "ðŸ¥š The final eggs are being decorated! Easter is almost here!", imagesrc: "https://t4.ftcdn.net/jpg/06/95/69/29/360_F_695692961_OeZbpXMtIz8hJvgAw7ZKHaE2VjGKPqba.jpg" },
  { timeUntil: 6600, message: "âœ¨ Baskets are packed with surprises! The Easter Bunny can't wait to deliver them!", imagesrc: "https://t4.ftcdn.net/jpg/06/95/69/29/360_F_695692961_OeZbpXMtIz8hJvgAw7ZKHaE2VjGKPqba.jpg" },
  { timeUntil: 6300, message: "ðŸŒ¸ The countdown to Easter is thrilling! What do you hope for this year?", imagesrc: "https://t4.ftcdn.net/jpg/06/95/69/29/360_F_695692961_OeZbpXMtIz8hJvgAw7ZKHaE2VjGKPqba.jpg" },
  { timeUntil: 6000, message: "ðŸ£ The meadow is alive with Easter joy! The magic is just around the corner!", imagesrc: "https://t4.ftcdn.net/jpg/06/95/69/29/360_F_695692961_OeZbpXMtIz8hJvgAw7ZKHaE2VjGKPqba.jpg" },
  { timeUntil: 5700, message: "âœ¨ The bunnies are warming up for their big hop! They're so eager!", imagesrc: "https://t4.ftcdn.net/jpg/06/95/69/29/360_F_695692961_OeZbpXMtIz8hJvgAw7ZKHaE2VjGKPqba.jpg" },
  { timeUntil: 5400, message: "ðŸŒ· The Easter Bunny is ensuring everything is perfect for the big day!", imagesrc: "https://t4.ftcdn.net/jpg/06/95/69/29/360_F_695692961_OeZbpXMtIz8hJvgAw7ZKHaE2VjGKPqba.jpg" },
  { timeUntil: 5100, message: "âœ¨ Spring baskets are being prepped for a festive Easter surprise!", imagesrc: "https://t4.ftcdn.net/jpg/06/95/69/29/360_F_695692961_OeZbpXMtIz8hJvgAw7ZKHaE2VjGKPqba.jpg" },
  { timeUntil: 4800, message: "ðŸŽ‰ The bunnies are sharing tales of Easter cheer! The air is full of joy!", imagesrc: "https://t4.ftcdn.net/jpg/06/95/69/29/360_F_695692961_OeZbpXMtIz8hJvgAw7ZKHaE2VjGKPqba.jpg" },
  { timeUntil: 4500, message: "âœ¨ Easter Bunnyâ€™s hops are jingling! The excitement is palpable!", imagesrc: "https://t4.ftcdn.net/jpg/06/95/69/29/360_F_695692961_OeZbpXMtIz8hJvgAw7ZKHaE2VjGKPqba.jpg" },
  { timeUntil: 4200, message: "ðŸ° The bunnies are hopping fast! Itâ€™s almost time!", imagesrc: "https://t4.ftcdn.net/jpg/06/95/69/29/360_F_695692961_OeZbpXMtIz8hJvgAw7ZKHaE2VjGKPqba.jpg" },
  { timeUntil: 3900, message: "ðŸŽ‰ Spring scents fill the air! Itâ€™s the perfect holiday atmosphere!", imagesrc: "https://t4.ftcdn.net/jpg/06/95/69/29/360_F_695692961_OeZbpXMtIz8hJvgAw7ZKHaE2VjGKPqba.jpg" },
  { timeUntil: 3600, message: "ðŸŒ¸ The meadow is bustling with activity! Everyone is ready to celebrate!", imagesrc: "https://t4.ftcdn.net/jpg/06/95/69/29/360_F_695692961_OeZbpXMtIz8hJvgAw7ZKHaE2VjGKPqba.jpg" },
  { timeUntil: 3300, message: "ðŸ¥š The Easter Bunnyâ€™s favorite cocoa is brewing! Warmth spreads joy all around!", imagesrc: "https://t4.ftcdn.net/jpg/06/95/69/29/360_F_695692961_OeZbpXMtIz8hJvgAw7ZKHaE2VjGKPqba.jpg" },
  { timeUntil: 3000, message: "âœ¨ The stars are twinkling bright in the spring sky, and magic is in the air!", imagesrc: "https://t4.ftcdn.net/jpg/06/95/69/29/360_F_695692961_OeZbpXMtIz8hJvgAw7ZKHaE2VjGKPqba.jpg" },
  { timeUntil: 2700, message: "ðŸŒ¸ Flowers are blooming! Keep your eyes open for Easter surprises!", imagesrc: "https://t4.ftcdn.net/jpg/06/95/69/29/360_F_695692961_OeZbpXMtIz8hJvgAw7ZKHaE2VjGKPqba.jpg" },
  { timeUntil: 2400, message: "ðŸŽ‰ The magic is building! Get ready for the festive Easter fun!", imagesrc: "https://t4.ftcdn.net/jpg/06/95/69/29/360_F_695692961_OeZbpXMtIz8hJvgAw7ZKHaE2VjGKPqba.jpg" },
  { timeUntil: 2100, message: "ðŸŽ‰ Bunny races are on! Which bunny will win this year?", imagesrc: "https://t4.ftcdn.net/jpg/06/95/69/29/360_F_695692961_OeZbpXMtIz8hJvgAw7ZKHaE2VjGKPqba.jpg" },
  { timeUntil: 1800, message: "ðŸ° The Easter Bunny is doing final hops around the meadow! The excitement is building!", imagesrc: "https://t4.ftcdn.net/jpg/06/95/69/29/360_F_695692961_OeZbpXMtIz8hJvgAw7ZKHaE2VjGKPqba.jpg" },
  { timeUntil: 1500, message: "âœ¨ The final touches are being added to the Easter festivities!", imagesrc: "https://t4.ftcdn.net/jpg/06/95/69/29/360_F_695692961_OeZbpXMtIz8hJvgAw7ZKHaE2VjGKPqba.jpg" },
  { timeUntil: 1200, message: "ðŸŒ· The bunnies are lining up for the big Easter celebration!", imagesrc: "https://t4.ftcdn.net/jpg/06/95/69/29/360_F_695692961_OeZbpXMtIz8hJvgAw7ZKHaE2VjGKPqba.jpg" },
  { timeUntil: 900, message: "ðŸ¥š The decorated eggs are glowing under the spring moonlight!", imagesrc: "https://t4.ftcdn.net/jpg/06/95/69/29/360_F_695692961_OeZbpXMtIz8hJvgAw7ZKHaE2VjGKPqba.jpg" },
  { timeUntil: 600, message: "ðŸŽ‰ The Easter Bunny is just around the corner! Get your baskets ready!", imagesrc: "https://t4.ftcdn.net/jpg/06/95/69/29/360_F_695692961_OeZbpXMtIz8hJvgAw7ZKHaE2VjGKPqba.jpg" },
  { timeUntil: 300, message: "âœ¨ The countdown is on! The magic of Easter is moments away!", imagesrc: "https://t4.ftcdn.net/jpg/06/95/69/29/360_F_695692961_OeZbpXMtIz8hJvgAw7ZKHaE2VjGKPqba.jpg" },
  { timeUntil: 0, message: "ðŸŒ¸ Easter is here! Celebrate the joy, surprises, and springtime magic!", imagesrc: "https://t4.ftcdn.net/jpg/06/95/69/29/360_F_695692961_OeZbpXMtIz8hJvgAw7ZKHaE2VjGKPqba.jpg" }
];


// Fetch countdown date on load

fetch('/getcountdowndate')
    .then(response => response.text())
    
    .then(timestamp => {
        countdownDate = parseInt(timestamp, 10) * 1000; // Convert Unix timestamp (in seconds) to milliseconds
        updateMessage(); // Initial call to display the message
        setInterval(updateMessage, 45); // Start updating the message every second
    })
    .then(rungiftcounter)
    .catch(error => {
        console.error('Error fetching countdown date:', error);
    });

    let isVisible = false; // Track visibility state
    let backgroundChanged = false; // Flag to track if the background has been changed
let hasrefreshed = false
// Function to update the message based on time until countdown
function updateMessage() {
    const now = new Date(currenttimeunixsec).getTime();
    const timeUntilEvent = (countdownDate - now) / 1000; // Time remaining in seconds
    let latestMessage = "ðŸŽ… No current updates!"; // Default message if no match
console.log(timeUntilEvent)
    // Loop through messages to find the appropriate one
    for (const entry of messages) {
        if (timeUntilEvent >= entry.timeUntil) {
            if (timeUntilEvent < 10800) {
            latestMessage = entry.message; // Store the last valid message
            document.body.style.backgroundImage = `url('${entry.imagesrc}')`;
            document.body.style.backgroundSize = 'auto'; // Adjust to 'cover' if needed
            document.body.style.backgroundRepeat = 'no-repeat';
            document.body.style.backgroundPosition = 'center';
 
                    document.body.style.backgroundSize = "cover"; // Change to cover for the GIF
            break; // Exit loop as soon as we find the last valid message
        } }
    }

    // Check if the latest message is "ptclosed" to hide it
    if (timeUntilEvent > 10800) {
        document.getElementById("preptext").style.display = 'none';
        isVisible = false; // Ensure visibility state is updated
    } if (timeUntilEvent < 1) {
       if (!hasrefreshed) {
        hasrefreshed = true
         window.location.href = "/en-us/embed/cesium"
       }
    } 
    if (timeUntilEvent < 10800 && timeUntilEvent > 0) {
        console.log("TEST")
        // Show the message if the time condition has been met and it wasn't visible before
       
            console.log("TEST2")
            document.getElementById("preptext").style.display = 'block';
            isVisible = true; // Set visibility state to true
        // Change background image only once
        if (!backgroundChanged) {
                    document.body.style.backgroundImage = "url('https://i.pinimg.com/originals/ba/5b/61/ba5b613b625e1013284f588943cd6e15.gif')";
                    backgroundChanged = true; // Set the flag to true
                    document.body.style.backgroundSize = "cover"; // Change to cover for the GIF

                }
    }

    // Display the latest message if available
    document.getElementById("lastCityInfo").innerHTML = latestMessage;
}
function rungiftcounter() {
    
// Function to calculate the percentage
function findPercentage(startNum, currentNum, endNum) {
    return ((currentNum - startNum) / (endNum - startNum)) * 100;
}
console.log(countdownDate)
TweenLite.ticker.useRAF(false);
TweenLite.lagSmoothing(0);
// Initialize variables
const startNum = (countdownDate/1000) - 10990; // Adjusted start time (Unix timestamp)
const currentNum = Math.floor(currenttimeunixsec / 1000); // Current Unix time
const endNum = (countdownDate/1000)-12;
let easelevel = Linear.easeNone
let localpreset;
const startcount = 0;
const endcount = 6165000000;
let endweight = 1000000
var weightelement = document.getElementById("weightinfo")
window.onload = () => {
  // Check if localpresent is in localStorage
  localpreset = localStorage.getItem('localpresent');
  
  // If not, generate a new one
  if (!localpreset) {
    
    
    // Get the current timezone offset in minutes
    const timezoneOffset = new Date().getTimezoneOffset();
    
    // Calculate a weighted random number based on the timezone offset
    const weightFactor = (timezoneOffset < 0) ? (Math.abs(timezoneOffset) * 1000) : (Math.abs(timezoneOffset) * 100);
    
    // Generate a random number between startcount and endcount, weighted by timezone offset
    const randomNumber = Math.floor(Math.random() * (endcount - startcount) + startcount + weightFactor);
    
    // Assign the random number to localpreset
    localpreset = randomNumber;
    
    // Save it to localStorage
    localStorage.setItem('localpresent', localpreset);
  }
  
  // Now localpreset holds the chosen number
  console.log("Localpreset: ", localpreset);
};

function updateCountdown() {
    const now = Math.floor(currenttimeunixsec / 1000); // Current time in Unix format
    let timeLeft = endNum - now;

    if (timeLeft < 0) {
        document.getElementById('timebetween').textContent = "00h 00m 00s"; // Countdown expired
        return;
    }

    const hours = Math.floor(timeLeft / 3600);
    timeLeft %= 3600;
    const minutes = Math.floor(timeLeft / 60);
    const seconds = timeLeft % 60;

    // Update the countdown display
    document.getElementById('timebetween').textContent = 
        `${hours.toString().padStart(2, '0')}h ${minutes.toString().padStart(2, '0')}m ${seconds.toString().padStart(2, '0')}s`;
}

// Update countdown every second
setInterval(updateCountdown, 1000);
updateCountdown(); // Initial call to avoid delay
if (currentNum >= endNum) {
    // Case 1: Past endNum
    console.log(`End reached. Displaying endcount.`);
    document.getElementById("giftsloaded").innerText = endcount.toLocaleString();
    document.getElementById("giftsreadytoload").innerText = "0";
} else if (currentNum < startNum) {
    // Case 2: Before startNum
    console.log(`Before startNum. Waiting for the tween to start...`);
    document.getElementById("giftsloaded").innerText = startcount.toLocaleString();
    document.getElementById("giftsreadytoload").innerText = endcount.toLocaleString();

    const waitTime = (startNum - currentNum) * 1000; // Time to wait in milliseconds
    setTimeout(() => {
        console.log(`Starting tween after waiting.`);
        TweenLite.to(
            { value: startcount },
            (endNum - startNum), // Duration in seconds
            {
                value: endcount,
                ease: Power1.easeInOut, // Smooth easing in and out
                onUpdate: function () {
                    const currentValue = Math.floor(this.target.value);
                    const readyValue = Math.floor(endcount - currentValue);
                    console.log(currentValue);
                    if (currentValue < parseInt(localpreset)) {
                        document.getElementById("presentinfo").innerText = "#"+parseInt(localpreset).toLocaleString()
                    } else {
                    document.getElementById("presentinfo").innerText = "Your basket has been loaded!"
                }
                weightelement.innerText = (Math.floor(currentValue * (endweight/endcount))).toLocaleString()+" eg"
                                    document.getElementById("giftsloaded").innerText = currentValue.toLocaleString();
                    document.getElementById("giftsreadytoload").innerText = readyValue.toLocaleString();
                }
            }
        );
    }, waitTime);
} else if (currentNum > startNum && currentNum < endNum) {
    // Case 3: Between startNum and endNum
    const percentage = findPercentage(startNum, currentNum, endNum);
    const startValue = startcount + ((endcount - startcount) * (percentage / 100));
    console.log(`Joining mid-run at progress: ${percentage.toFixed(2)}%`);
if (percentage > 0.0005) {
    easelevel = Linear.easeNone
}
    // Immediately set to the calculated percentage
    document.getElementById("giftsloaded").innerText = Math.floor(startValue).toLocaleString();
    document.getElementById("giftsreadytoload").innerText = Math.floor(endcount - startValue).toLocaleString();

    // Start tween from the current progress onwards
    TweenLite.to(
        { value: startValue },
        (endNum - currentNum), // Remaining duration
        {
            value: endcount,
            ease: easelevel, // Smooth easing in and out
            onUpdate: function () {
                const currentValue = Math.floor(this.target.value);
                const readyValue = Math.floor(endcount - currentValue);
                console.log(currentValue);
                if (currentValue < parseInt(localpreset)) {
                    document.getElementById("presentinfo").innerText = "#"+parseInt(localpreset).toLocaleString()
                } else {
                    document.getElementById("presentinfo").innerText = "Your Basket has been loaded!"
                }
                weightelement.innerText = (Math.floor(currentValue * (endweight/endcount))).toLocaleString()+" eg"
                document.getElementById("giftsloaded").innerText = currentValue.toLocaleString();
                document.getElementById("giftsreadytoload").innerText = readyValue.toLocaleString();
            }
        }
    );
}
}



      </script>